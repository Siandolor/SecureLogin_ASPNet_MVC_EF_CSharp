@{
    ViewData["Title"] = "Benutzerprofil â€“ " + @User.Identity?.Name;
    Layout = "_Layout";
}

<div class="container mt-5">
    <h2 class="text-center mb-4">@ViewData["Title"]</h2>
    
    <div class="alert alert-warning text-center">
        <b>Achtung:</b> Diese Ansicht ist nur zu Demonstrationszwecken gedacht.
        In Produktivsystemen darf sie <u>niemals</u> aktiv sein.
    </div>
    
    <table class="table table-bordered table-striped mt-4">
        <tbody>
            <tr>
                <th style="width: 30%">Klartext-Benutzername</th>
                <td>@Model.Username</td>
            </tr>
            
            <tr>
                <th>Klartext-Passwort</th>
                <td>
                    <b class="text-muted text-secondary-emphasis">
                        Ein eingegebenes Passwort wird sofort gehasht (zweistufig) und nur mit dem gespeicherten Hash verglichen.
                        Der Klartext wird <u>niemals</u> gespeichert oder im Speicher persistiert.
                    </b>
                </td>
            </tr>
            
            <tr class="table-active">
                <th colspan="2" class="text-center">ğŸ” Hash- & Salt-Pipeline (zweistufig)</th>
            </tr>
            
            <tr>
                <th>Phase 1 Hashing mittels SHA3-512</th>
                <td>
                    <small class="text-muted">
                        <b>Funktion:</b> SHA3-512 (erste Hashphase)<br/>
                        
                        <b>Saltquelle:</b> <i>SaltUtility.GenerateShaSalt()</i><br/>
                        
                        <b>Beschreibung:</b> Zufallsbasiert (RandomNumberGenerator) + leicht XOR-verrauscht. 
                        Dient als Vor-Hash zur Diffusion vor der SpeicherhÃ¤rtung.
                    </small>
                </td>
            </tr>
            
            <tr>
                <th>Fallback - mit SHA2-512</th>
                <td>
                    <small class="text-muted">
                        Wenn <b>SHA3-512</b> nicht erreichbar ist, wird <b>SHA2-512</b> verwendet fÃ¼r <b>Phase 1</b>
                    </small>
                </td>
            </tr>
            
            <tr>
                <th>Salt â€“ "SHA3-512/SHA2-512"-Phase</th>
                <td><code>@Model.SaltSHA512</code></td>
            </tr>
            
            <tr>
                <th>Phase 2 Hashing mittels Argon2id</th>
                <td>
                    <small class="text-muted">
                        <b>Funktion:</b> Argon2id (Iterations = 6, Memory = 256 MiB, Parallelism = alle verfÃ¼gbaren CPU-Kerne)<br/>
                        
                        <b>Saltquelle:</b> <i>SaltUtility.GenerateArgonSalt()</i><br/>
                        
                        <b>Beschreibung:</b> Zufallsbasiert (RandomNumberGenerator) + SHA-3/512-diffundiert 
                        + bitweise Rotation zur zusÃ¤tzlichen Entropieverteilung. 
                        Haupt-Hash mit speicher- und CPU-harter Struktur.
                    </small>
                </td>
            </tr>
            
            <tr>
                <th>Salt â€“ "Argon2id"-Phase</th>
                <td><code>@Model.SaltArgon2id</code></td>
            </tr>
            
            <tr>
                <th>EndgÃ¼ltiger Passwort-Hash</th>
                <td>
                    <code>@Model.PasswordHash</code><br/>
                    <small class="text-muted">
                        Ergebnis der zweistufigen Hashkette (SHA3-512 â†’ Argon2id). 
                        Wird in <i>Identity</i> als <b>PasswordHash</b> gespeichert.
                    </small>
                </td>
            </tr>
            
            <tr>
                <th>Regeln fÃ¼r die Registrierung</th>
                <td>
                    <small class="text-muted">
                        <b>Benutzername</b> muss unique sein.<br/>
                        
                        <b>Passwort</b> muss aus mindestens 4 Zeichen bestehen:<br/>
                        
                        davon jeweils mindestens:
                        
                        <ul>
                            <li>eine Ziffer (0-9)</li>
                            <li>ein Kleinbuchstabe (a-z)</li>
                            <li>ein GroÃŸbuchstabe (A-Z)</li>
                            <li>ein Sonderzeichen</li>
                        </ul>
                    </small>
                </td>
            </tr>
            
            <tr>
                <th>Lockout</th>
                <td>
                    <small class="text-muted">
                        Der Lockout erfolgt nach 5 Fehlversuchen mit einer Sperrdauer von 1 Minute!
                    </small>
                </td>
            </tr>
            
            <tr>
                <th>Anzahl an Kombinationen</th>
                <td>
                    <p>
                        Je nach <b>PasswortlÃ¤nge</b> verÃ¤ndert sich die 
                        <b>Anzahl mÃ¶glicher Kombinationen</b> entsprechend dieser Formel:
                    </p>
                    <small class="text-muted">
                        <div class="mt-2">
                            <strong>Induktive Formel:</strong><br />
                            <code>
                                F(L) = Î£<sub>kâ‚..kâ‚„ â‰¥ 1, kâ‚+...+kâ‚„ = L</sub> 
                                (L! / (kâ‚! kâ‚‚! kâ‚ƒ! kâ‚„!)) Â· (sâ‚<sup>kâ‚</sup> Â· sâ‚‚<sup>kâ‚‚</sup> Â· sâ‚ƒ<sup>kâ‚ƒ</sup> Â· sâ‚„<sup>kâ‚„</sup>)
                            </code><br/>
                            mit: <b>L</b> als GesamtlÃ¤nge des Passworts (z.B. 4, 5, 8 oder 12 Zeichen), 
                            <b>kâ‚, kâ‚‚, kâ‚ƒ, kâ‚„</b> als Anzahl der Zeichen, die aus jeder der vier Zeichengruppen stammen: 
                            (<b>kâ‚</b> fÃ¼r Ziffern, <b>kâ‚‚</b> fÃ¼r Kleinbuchstaben, <b>kâ‚ƒ</b> fÃ¼r GroÃŸbuchstaben, <b>kâ‚„</b>: Sonderzeichen). 
                            Alle <b>káµ¢ â‰¥ 1</b> und ihre Summe ergibt die PasswortlÃ¤nge L â†’ <b>kâ‚ + kâ‚‚ + kâ‚ƒ + kâ‚„ = L</b>.<br/>
                            FÃ¼r <b>sâ‚, sâ‚‚, sâ‚ƒ, sâ‚„</b> als die GrÃ¶ÃŸe der jeweiligen ZeichensÃ¤tze gilt: 
                            <b>sâ‚ = 10</b> (Ziffern), <b>sâ‚‚ = 26</b> (Kleinbuchstaben), <b>sâ‚ƒ = 26</b> (GroÃŸbuchstaben), <b>sâ‚„ = 32</b> (Sonderzeichen im ASCII-Bereich).
                        </div>
                        
                        <div class="mt-2">
                            <em>ErklÃ¤rung:</em> FÃ¼r jede mÃ¶gliche Zerlegung der PasswortlÃ¤nge <span class="text-secondary">L</span> auf die vier Zeichengruppen (jeweils â‰¥ 1) 
                            wird eine bestimmte Anzahl <span class="text-secondary">k<sub>i</sub></span> von Zeichen aus dem Zeichensatz 
                            <span class="text-secondary">s<sub>i</sub></span> gewÃ¤hlt. Diese Auswahl wird mit dem Multinomialfaktor 
                            <span class="text-secondary">L! / (kâ‚! kâ‚‚! kâ‚ƒ! kâ‚„!)</span> kombiniert, um alle mÃ¶glichen Anordnungen der Zeichen zu berÃ¼cksichtigen.
                        </div>
                        
                        <div class="mt-2">
                            <em>FÃ¼r 4-stellige PasswÃ¶rter gilt daher:</em><br />
                            <code>
                                F(4) = Î£ (4! / (kâ‚!kâ‚‚!kâ‚ƒ!kâ‚„!)) Â· (10^{kâ‚} Â· 26^{kâ‚‚} Â· 26^{kâ‚ƒ} Â· 32^{kâ‚„})<br/>
                                â‰ˆ 5,190 Ã— 10â¶ Kombinationen
                            </code>
                        </div>
                        
                        <div class="mt-2">
                            <em>FÃ¼r 5-stellige PasswÃ¶rter gilt daher:</em><br />
                            <code>
                                F(5) = Î£ (5! / (kâ‚!kâ‚‚!kâ‚ƒ!kâ‚„!)) Â· (10^{kâ‚} Â· 26^{kâ‚‚} Â· 26^{kâ‚ƒ} Â· 32^{kâ‚„})<br/>
                                â‰ˆ 2,600 Ã— 10Â¹â° Kombinationen
                            </code>
                        </div>
                        
                        <div class="mt-2">
                            <em>FÃ¼r 8-stellige PasswÃ¶rter gilt daher:</em><br />
                            <code>
                                F(8) = Î£ (8! / (kâ‚!kâ‚‚!kâ‚ƒ!kâ‚„!)) Â· (10^{kâ‚} Â· 26^{kâ‚‚} Â· 26^{kâ‚ƒ} Â· 32^{kâ‚„})<br/>
                                â‰ˆ 3,700 Ã— 10Â¹âµ Kombinationen
                            </code>
                        </div>
                        
                        <div class="mt-2">
                            <em>FÃ¼r 12-stellige PasswÃ¶rter gilt daher:</em><br />
                            <code>
                                F(12) = Î£ (12! / (kâ‚!kâ‚‚!kâ‚ƒ!kâ‚„!)) Â· (10^{kâ‚} Â· 26^{kâ‚‚} Â· 26^{kâ‚ƒ} Â· 32^{kâ‚„})<br/>
                                â‰ˆ 5,600 Ã— 10Â²Â¹ Kombinationen
                            </code>
                        </div>
                    </small>
                </td>
            </tr>
            
            <tr>
                <th>Zeitfaktor fÃ¼r Brute-Force</th>
                <td>
                    <small class="text-muted">
                        <b>4-stellige PasswÃ¶rter</b> (Sperre: 1 Minute nach 5 Fehlversuchen):<br/>
                        <span>â‰ˆ (5,190 Ã— 10â¶ / 5) = 1,040 Ã— 10â¶ Minuten â‰ˆ 1,98 Jahre</span>
                    </small><br/>
                    
                    <small class="text-muted">
                        <b>5-stellige PasswÃ¶rter</b> (Sperre: 1 Minute nach 5 Fehlversuchen):<br/>
                        <span>â‰ˆ (2,600 Ã— 10Â¹â° / 5) = 5,200 Ã— 10â¹ Minuten â‰ˆ 9.880 Jahre</span>
                    </small><br/>
                    
                    <small class="text-muted">
                        <b>8-stellige PasswÃ¶rter</b> (Sperre: 1 Minute nach 5 Fehlversuchen):<br/>
                        <span>â‰ˆ (3,700 Ã— 10Â¹âµ / 5) = 7,400 Ã— 10Â¹â´ Minuten â‰ˆ 1,400 Milliarden Jahre</span>
                    </small><br/>
                    
                    <small class="text-muted">
                        <b>12-stellige PasswÃ¶rter</b> (Sperre: 1 Minute nach 5 Fehlversuchen):<br/>
                        <span>â‰ˆ (5,600 Ã— 10Â²Â¹ / 5) = 1,120 Ã— 10Â²Â¹ Minuten â‰ˆ 2,100 Ã— 10Â¹âµ Jahre</span>
                    </small>
                    
                    <div class="alert alert-info mt-3">
                        <b>Offline-Angriff (z.B. bei Datenbank-Leak):</b> Jeder Versuch muss zwei 512â€‘Bitâ€‘RÃ¤ume vollstÃ¤ndig durchlaufen: zuerst SHA3â€‘512 + Salt (fÃ¼r SHA), danach Argon2id + Salt (fÃ¼r Argon2).<br/>
                        <b>Wichtig:</b> Beide Ebenen erzeugen unabhÃ¤ngig diffundierte 2âµÂ¹Â² ZustÃ¤nde â€“ die PasswortlÃ¤nge spielt keine Rolle.<br/>
                        <b>Folge:</b> Ein Angreifer mÃ¼sste also alle 2âµÂ¹Â² mÃ¶gliche Hashketten auf Klartext prÃ¼fen unabhÃ¤ngig von den verwendeten Hash-Algorithmen.<br/>
                        <b>Angriffszeit:</b> Selbst theoretisch Ã¼bersteigt das alle physikalisch realisierbaren RechenkapazitÃ¤ten.<br/>
                        <b>Beispiel:</b> Selbst mit 4096 CPU-Kernen und je 1 Sekunde pro vollstÃ¤ndigem Versuch brÃ¤uchte ein Angreifer â‰ˆ 3,400 Ã— 10Â¹âµâ´ Jahre â€“ das Ã¼bersteigt alle denkbaren technischen MÃ¶glichkeiten.<br/>
                        <b>Fazit:</b> Diese Architektur ist praktisch offlineâ€‘bruchfest â€“ unabhÃ¤ngig von PasswortlÃ¤nge oder Hardware.
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    
    <div>
        <p>Bewertung nach Sicherheitsreifegrad:</p>
        <small class="text-muted">
            Diese Architektur erfÃ¼llt zentrale Anforderungen aus 
            <b>NIST SP 800-63B</b> (Digital Identity Guidelines) fÃ¼r den Schutz von 
            <i>memorized secrets</i> und die sichere Authentifizierung von Benutzerkonten.
            Sie implementiert folgende Sicherheitsprinzipien:
            <ul>
                <li><b>Â§5.1.1 â€“ Verifier Requirements:</b> Speicherung ausschlieÃŸlich 
                    verifizierbarer ReprÃ¤sentationen. Das Passwort wird zweistufig gehasht 
                    (<i>SHA3-512 â†’ Argon2id</i>) und niemals im Klartext persistiert.</li>
                <li><b>Â§5.1.2 â€“ Memorized Secret Verifiers:</b> Einsatz eines 
                    speicher- und CPU-harten Key-Derivation-Algorithmus 
                    (<i>Argon2id</i>) mit individuellen CSPRNG-basierten Salts.</li>
                <li><b>Â§5.1.3 â€“ Salted, Adaptive Hashing:</b> Verwendung 
                    zweier voneinander unabhÃ¤ngiger Salts (SHA- und Argon-Phase), 
                    um Pre-computation- und Rainbow-Table-Angriffe zu verhindern.</li>
                <li><b>Â§5.1.5 â€“ Verifier Compromise Resistance:</b> 
                    Selbst bei Datenbankkompromittierung bleibt der Hash durch 
                    zweifache Entropietrennung und speicherharte Berechnung widerstandsfÃ¤hig.</li>
                <li><b>Â§5.2.2 â€“ Rate Limiting:</b> Nach <b>5 Fehlversuchen</b> wird 
                    das Benutzerkonto <b>fÃ¼r 1 Minute gesperrt</b> (Fixed-Interval-Lockout).</li>
            </ul>
            ZusÃ¤tzlich erfÃ¼llt die Architektur die Anforderungen durch:<br/>
            <b>OWASP-Kategorie A02-2023 â€Cryptographic Failuresâ€œ</b>
            <ul>
                <li>Verzicht auf veraltete Hashfunktionen (kein MD5/SHA-1)</li>
                <li>Verwendung kryptographisch sicherer Zufallsquellen (CSPRNG)</li>
                <li>Transparente, auditierbare Hash-Pipeline ohne Klartextspeicherung</li>
            </ul>
            <b>Assurance Level:</b><br/>
            Die LÃ¶sung entspricht dem 
            <i>Authenticator Assurance Level 2 (AAL2)</i> gemÃ¤ÃŸ NIST SP 800â€‘63B â€“ 
            also dem Sicherheitsniveau, das u.a. bei Plattformen wie 
            <i>ELGA, FinanzOnline</i> oder <i>eIDAS-Level-2</i> Anwendung findet.
        </small>

        <div class="mt-2">
            <a href="https://pages.nist.gov/800-63-3/sp800-63b.html" 
               target="_blank" rel="noopener noreferrer" class="text-decoration-none text-danger">
                NIST SP 800-63B â€” Digital Identity Guidelines
            </a><br/>
            <a href="https://pages.nist.gov/800-63-3-Implementation-Resources/63B/AAL/" 
               target="_blank" rel="noopener noreferrer" class="text-decoration-none text-danger">
                Authenticator Assurance Level (AAL) Ãœbersicht
            </a>
        </div>
    </div>
    
    <div class="text-center mt-4 mb-5">
        <a class="btn btn-secondary" asp-controller="Home" asp-action="Index">ZurÃ¼ck zur Startseite</a>
    </div>
</div>
